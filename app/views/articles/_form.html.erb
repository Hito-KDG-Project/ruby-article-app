<%= form_with(model: article, local: true) do |f| %>
  <% if article.errors.any? %>
    <div class="alert alert-danger">
      <h2 class="h6 mb-2">
        <%= article.errors.count %>件のエラーにより<%= Article.model_name.human %>は保存できませんでした
      </h2>
      <ul class="mb-0 ps-3">
        <% article.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="card mb-4 col-lg-8 p-0">
    <div class="card-header">基本情報</div>
    <div class="card-body vstack gap-3">

      <%# タイトル（必須） %>
      <% title_error = article.errors.include?(:title) %>
      <div>
        <%= f.label :title,
              raw("#{article.class.human_attribute_name(:title)} <span class='text-danger'>✳️</span>"),
              class: "form-label" %>
        <%= f.text_field :title,
              class: ["form-control", ("is-invalid" if title_error)].compact.join(" "),
              placeholder: "例）はじめてのRails",
              required: true, aria: { required: true } %>
        <% if title_error %>
          <div class="invalid-feedback">
            <%= article.errors.full_messages_for(:title).first %>
          </div>
        <% end %>
      </div>

      <%# 本文（必須） %>
      <% body_error = article.errors.include?(:body) %>
      <div>
        <%= f.label :body,
              raw("#{article.class.human_attribute_name(:body)} <span class='text-danger'>✳️</span>"),
              class: "form-label" %>
        <%= f.text_area :body, rows: 8,
              class: ["form-control", ("is-invalid" if body_error)].compact.join(" "),
              placeholder: "本文を入力",
              required: true, aria: { required: true } %>
        <% if body_error %>
          <div class="invalid-feedback">
            <%= article.errors.full_messages_for(:body).first %>
          </div>
        <% end %>
      </div>

      <%# 要約（任意） %>
      <% summary_error = article.errors.include?(:summary) %>
      <div>
        <%= f.label :summary, article.class.human_attribute_name(:summary), class: "form-label" %>
        <%= f.text_field :summary,
              class: ["form-control", ("is-invalid" if summary_error)].compact.join(" "),
              placeholder: "本文の要点（省略可）" %>
        <% if summary_error %>
          <div class="invalid-feedback">
            <%= article.errors.full_messages_for(:summary).first %>
          </div>
        <% end %>
      </div>

    </div>

    <div class="card-footer d-flex justify-content-between">
      <div class="text-muted small">
        <span class="text-danger">✳️</span> は必須項目です
      </div>
      <%= f.submit "保存する", class: "btn btn-primary" %>
    </div>
  </div>
<% end %>
